## Write-up

The challenge consists of an RSA public key and an RSA-encrypted flag file. We started by inspecting the RSA public key:

>```bash
>$ cat flag.enc
C6DKgZR8miTtrxaz9hQ230qK6BZ4xp4YdlmDYynTsl2X5h5qU5CWs+S+/i6nuM7Pn7KVvYOw2HAoZnB9JBImJVvRzWHBzGylLKZUcJe6ZbQL6v7BX8MvWI/WVO9PCGNoNoIz/Qy/z5Gh7PEjLx/3THbx87+cZc+8PwCnZk3YmEkl3Imzhxw/kYAd+B7pCJsiqyGNQSN77SgjLvaz5+5iuHPSF4zdUV0VjadSjhxaOK1J6HFgcJPdAMywy6LpOoUum+RHyveuYpxra0mwye4imLWftyptMFJPD84D3M+hPoLK8kPEzJvRPopmtHxGrMLbaDvH1QcZ8C7piWnY1LPkj3uUZtLHetqSqOhbYh6Kgeyat0VAkPuFrUAYq5mPijnE7lTngwCaWIoHZd9MNaxJt4I8JdUjC6rUtuJFY5fGzEGa2KfbUqFiHpir+zrFqmKOV2KZZuodTllSjmEEkIoZnwctf8KTTKEOyt7MU0F3V6Hc5OlrvPlQOyeylNU3vb5Z7AXmXOuggU4/rZvOCWAezWsAzddAtrhCUqqJr1NyACjmS+o7kdmalv03LxGz6780vQrnTgUDUfwqFtCXBlYYfAEtdRpiHBZyDMeZdIT+DzEq1D1cPPf08vE2GFtNwTGco6hcChTWLPU/YMz9Nr2snyDGXt5Re1z1SoJ58qwccTxSddbqgLk1EeKExf2HlypCSywedpsOJNgEO9x2X80xLercFMcKUMFPZTlbJelGBGiWMBPde
>```
>$ cat id_rsa.pub

-----BEGIN PUBLIC KEY-----<br>
MIICUjANBgkqhkiG9w0BAQEFAAOCAj8AMIICOgKCAjEP////////////////////<br>
////////////////////////////////////////////////////////////////<br>
////////////////////////////////////////////////////////////////<br>
////////////////////////////////////////////////////////////////<br>
////////////////////////////////////////////////////////////////<br>
////////////////////////////////////////////////////////////////<br>
//////////////////////////3////////////4AAAAAAAAAAAAAAAAAAAAAAAA<br>
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<br>
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<br>
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<br>
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<br>
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<br>
AAAAAAAAAAAAAAAAAAAAAAECAwEAAQ==<br>
-----END PUBLIC KEY-----<br>

It is immediately obvious the public modulus is highly abnormal, both in size (4485 bits) and composition (the large amount of 1 bits followed by the large amount of zeros and a single trailing 1). The binary representation of the public modulus looks as follows:

> 0b11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111101111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001

Seeing as the 2281 higher-order bits are all 1s followed by 2203 lower-order bits (consisting of all-zeros and a single trailing 1) this means the public modulus can be expressed as:

> (2^2281 - 1)(2^2203 - 1)

Which is effectively its factorization. Using this we can [python script](RSA.py) obtain the private key and decrypt the ciphertext:

Which gives us:

>```bash
>$ python rsanne.py
![alt tag](https://github.com/MrMugiwara/RedEye-CTF-2017/tree/master/Cryptography/RSABaby/flag.jpg)
>```
